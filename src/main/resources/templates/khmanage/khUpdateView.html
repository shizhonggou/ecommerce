<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" >
<head>
    <link  th:href="@{/css/bass.css}" rel="stylesheet" type="text/css" />
    <script th:src="@{/js/jquery.min.js}" type="text/javascript"></script>
    <script th:src="@{/js/userInfo.js}" type="text/javascript"></script>
    <script th:src="@{/js/resource.js}" type="text/javascript"></script>
    <meta content="text/html; charset=utf-8" http-equiv=Content-Type>
    <meta http-equiv="X-UA-Compatible" content="IEedge">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <title>账号信息修改</title>
</head>
<body>
<div th:insert="~{header :: header}"></div>
<section>
    <div class="main w1000">
        <aside>
            <div th:insert="~{left :: left(khmanage)}"></div>
        </aside>
        <aside>
            <div class="resources">
                <div class="resources_tt" th:include="common::varietyTag2"></div>
                <div class="pozition"><p>当前位置：会员中心  &gt; 客户管理    &gt; 修改</p></div>
                <form action="/khmanage/khUpdate" name="khform" id="khform"  method="POST" enctype="multipart/form-data">
                    <table class="Information" cellspacing="0" cellpadding="0" border="0">
                        <tbody>   
                        <tr>
                            <td>审核状态</td>
                            <td >                        
                                <select name="status" style="width: 70%; color: #3333338c; padding: 8px 20px; margin: 12px auto; display: inline-block;border: 1px solid #ccc; border-radius: 0px;box-sizing: border-box;">
                                <option th:selected="${khdetail.status == 0}" value="0">未审核</option>
                                <option th:selected="${khdetail.status == 1}" value="1">已审核</option>
                            </select></td>
                            <td>优惠幅度</td>
                            <td ><input type="text" name="preferentialAmount" id="preferentialAmount" th:value="${khdetail.preferentialAmount}" > </td>
                        </tr>
                        <tr>
                            <td>客户类型</td>
                            <td >                        
                                <select name="member_type" style="width: 70%; color: #3333338c; padding: 8px 20px; margin: 12px auto; display: inline-block;border: 1px solid #ccc; border-radius: 0px;box-sizing: border-box;" onchange="show_input(this.value)">
                                <option th:selected="${khdetail.member_type == 1}" value="1">现款现货</option>
                                <option  th:selected="${khdetail.member_type == 2}" value="2">先货后款</option>
                            </select></td>
                            <td align="left">额度</td>
                            <td><input th:style="${khdetail.member_type == 1} ? 'display:none;':''"  type="text" name="credit_amount" id="credit_amount" th:value="${khdetail.credit_amount}" ></td>
                        </tr>
                        <tr>
                            <td>合同上传</td>
                             <td><input type="file" name="file"> </td>
                             <td> <a th:if="${khdetail.con_file_url}" th:href="${khdetail.con_file_url}" download="" style="float: left; width: 30px; background:url(../images/fileshow.png);"></a></td>
                        </tbody>
                    </table>
          
                    <div style="text-align: center;">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                        <input type="hidden"  name="id" th:value="${khdetail.id}">
                        <input type="hidden"  name="reviewuid" th:value="${userID}">     
                        <input type="submit" value="保存"  style="background: #FF6632;color: white;width: 300px;height: 30px;border: 0;cursor:pointer;">
                    </div>
                </form>
            </div>
        </aside>
    </div>
</section>
<div th:insert="~{footer :: footer}"></div>
<div th:include="common::commonFooter"></div>
<script>


// 检查用户名 是否重复
function ajaxcheckuname(){
    // 校验用户名 只能是 数字字母 下划线
    var regUN = /^[0-9a-zA-Z_]{1,}$/;
    var user_name=document.getElementById("user_name").value.replace(/\s*/g,"");
    if (user_name == '' || user_name ==null) {
            alert("请输入用户名");
            user_name.focus();
            return false;
    } else if(!regUN.test(user_name)) {
            alert("用户名只能包含数字、字母、下划线");
            user_name.focus();
            return false;
    }
	$.ajax({
                type: "POST",
                url: "/userInfo/checkUName",
                data: {'user_name': user_name,"[[${_csrf.parameterName}]]": "[[${_csrf.token}]]"},
        success: function(data) {
			if(data==0){
			    alert("用户名重复，不可用");
			    var user_name2 = document.getElementById("user_name");
			    user_name2.value = '';
                return;
		    }
		},
	    error: function(request, status, error){
                        console.log(error);
        }
        });
}
    // 检查手机号码 是否重复
function ajaxchecktel(){
    // 校验手机号
    var regMobile = /^1[3,4,5,7,8]\d{9}$/;
    var mobile=document.getElementById("mobile").value.replace(/\s*/g,"");
    if (mobile == '' || mobile ==null) {
            alert("请输入手机号码");
            return false;
        } else if(!regMobile.test(mobile)){
            alert("请输入正确的手机号码");
            return false;
        }
		$.ajax({
		        type: "POST",
                url: "/userInfo/checkMobile",
                data: {'mobile': mobile,"[[${_csrf.parameterName}]]": "[[${_csrf.token}]]"},
        success: function(data) {
			if(data==0){
			    alert("手机号重复，不可用");
			    var mobile2=document.getElementById("mobile");
			    mobile2.value = '';
                return;
		    }
		},
	    error: function(request, status, error){
                        console.log(error);
        }
        });
}
function show_input(test_value){

if(test_value==2){

    document.getElementById("credit_amount").style.display="";

}else{

    document.getElementById("credit_amount").style.display="none";

}

}
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" >
<head>
    <link  th:href="@{/css/bass.css}" rel="stylesheet" type="text/css" />
    <script th:src="@{/js/jquery.min.js}" type="text/javascript"></script>
    <script th:src="@{/js/userInfo.js}" type="text/javascript"></script>
    <script th:src="@{/js/jquery-3.2.1.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/ajax.js}"></script>
    <script th:src="@{/js/resource.js}" type="text/javascript"></script>
    <meta content="text/html; charset=utf-8" http-equiv=Content-Type>
    <meta http-equiv="X-UA-Compatible" content="IEedge">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <title>账号管理</title>
</head>
<body>
<div th:insert="~{header :: header}"></div>
<section>
    <div class="main w1000">
        <aside>
            <div th:insert="~{left :: left(accountManage)}"></div>
        </aside>
        <aside>
            <div class="resources">
                <div class="resources_tt" th:include="common::varietyTag2"></div>
                <div class="pozition"><p>当前位置：会员中心  &gt; 会员管理 &gt; 账号管理 </p></div>
                <div class="cz2" th:if="${userLoginID} eq '1'">
                    <a href="/userInfo/accountAdd" target="_blank">新增账号</a>
                </div>
                <form name="form1" id="form1" th:action="@{'/userInfo/accountList'}" method="post">
                    <table class="management" cellspacing="0" cellpadding="0" border="0">
                        <thead>
                        <tr style="background: #f6f6f6;">
                            <td>用户id </td>
                            <td>姓名</td>
<!--                            <td>昵称</td>-->
                            <td>用户名</td>
                            <td>手机号</td>
                            <td>职位</td>
                            <td th:if="${userLoginID} eq '1'">主联系人</td>
                            <td th:if="${userLoginID} eq '1'">操作</td>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="accountList_item:${accountList}" align="center">
                            <td th:text="${accountList_item.id}"></td>
                            <td th:text="${accountList_item.arealname}"></td>
<!--                            <td th:text="${accountList_item.anickname}"></td>-->
                            <td th:text="${accountList_item.ausername}"></td>
                            <td th:text="${accountList_item.mobile}"></td>
                            <td th:text="${accountList_item.job}"></td>
                            <td th:if="${userLoginID} eq '1'"><input type="radio" name="zhulxr" th:checked="${accountList_item.ismain} eq '1'" th:value="${accountList_item.id}"> </td>
                            <td class="cz" th:if="${userLoginID} eq '1'"><span class="xg">
                            <a th:href="@{'/userInfo/accountDetail?id='+${accountList_item.id}}" target="_blank">修改</a>
                        </span><span class="delete">
                            <a th:href="@{'/userInfo/accountDelete?id='+${accountList_item.id}}"  onClick="return confirm('确定删除吗?');">删除</a>
                        </span></td>
                        </tr>
                        </tbody>
                    </table>
                    <div class="page">
                        <a th:href="'javascript:queryDeviceRecords('+${pageInfo.prePage}+');'">上一页</a>
                        <p th:each="navigatepageNum:${pageInfo.navigatepageNums}">
                            <a th:if="${navigatepageNum} eq ${pageInfo.pageNum}" class="now"
                               th:text="${navigatepageNum}"></a>
                            <a th:if=" ${navigatepageNum} ne ${pageInfo.pageNum}"
                               th:href="'javascript:queryDeviceRecords('+${navigatepageNum}+');'"
                               th:text="${navigatepageNum}"></a>
                        </p>
                        <a th:href="'javascript:queryDeviceRecords('+${pageInfo.nextPage}+');'">下一页</a>
                        <span>到第</span>
                        <input type="text" id="jump_num" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">
                        <span>页</span>
                        <button type="button" onclick="jumppage();">确定</button>
                    </div>
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                    <input type="hidden" name="page" id="page"/>
                    <input type="hidden" th:name="${_csrf.parameterName}"
                           th:value="${_csrf.token}"/>
                </form>
            </div>
        </aside>
    </div>
</section>
<div th:insert="~{footer :: footer}"></div>

<script type="text/javascript">
 $(function(){
  $(":radio").click(function(){
    var r = confirm('确定修改主联系人吗?');
    if (r == true) {
        var luId = $(this).val();
   $.ajax({
            type: "POST",//方法类型

            url: "/userInfo/accountUpdateZhuLXR",//url
            data: {'link_user_id':luId,
                    "[[${_csrf.parameterName}]]": "[[${_csrf.token}]]"
                  },
            success: function (data) {
                alert("设置主联系人成功！");
                    location.reload();
            },
            error: function(request, status, error){
                console.log(error);
                alert("设置主联系人失败！");
            }
        });
    }

  });
 });

 // 翻页
    function jumppage() {
        var pageNum = document.getElementById("jump_num").value;
        if (pageNum > 0) {
            queryDeviceRecords(pageNum);
        }
    }

    function find(pageNum) {
        document.getElementById('form1').submit();
    }

    function queryDeviceRecords(pageNum) {
        $("#page").val(pageNum);
        document.getElementById('form1').submit();
    }
</script>

</body>
</html>